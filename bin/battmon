#!/usr/bin/env bash

# ------------------------------------------------------------------
# Script Name:   battmon.sh
# Description:   A Simple Bash Script for Battery Level Charge
#                Notifications
# Website:       https://gist.github.com/ostechnix
# ------------------------------------------------------------------

# Define thresholds
HIGH_THRESHOLD=97
LOW_THRESHOLD=10

# Get the battery level
LEVEL=$(acpi -b | awk -F', ' '{print $2}' | tr -d '%,')
STATUS=$(acpi -b | awk -F': ' '{print $2}' | awk -F', ' '{print $1}')

# Ensure LEVEL is a valid number
if [[ "$LEVEL" =~ ^[0-9]+$ ]]; then
    # Check for high battery level
    if [[ "$LEVEL" =~ ^[0-9]+$ ]]; then
        if [ "$STATUS" = "Charging" ] && [ "$LEVEL" -ge "$HIGH_THRESHOLD" ]; then
            DISPLAY=:0 XDG_RUNTIME_DIR=/run/user/1000 notify-send -t 7000 "Battery Full" "Your battery is now fully charged."
        fi
    fi

    # Check for low battery level
    if [ "$LEVEL" -le "$LOW_THRESHOLD" ]; then
        DISPLAY=:0 XDG_RUNTIME_DIR=/run/user/1000 notify-send -t 7000 "Battery Low" "Your battery is critically low. Please plug in your charger!"
    fi
fi
